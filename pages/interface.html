<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Uzaktan Kontrol Paneli</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      @media (pointer: coarse) {
        html,
        body,
        * {
          cursor: none !important;
          -webkit-tap-highlight-color: transparent !important;
        }
      }

      :root {
        --primary-color: #007bff;
        --primary-color-dark: #0056b3;
        --secondary-color: #6c757d;
        --background-color: #f5f5f5;
        --text-color: #212529;
      }

      body {
        font-family: "Segoe UI", Arial, sans-serif;
        padding: 20px;
        max-width: 1000px;
        margin: auto;
        background-color: var(--background-color);
        color: var(--text-color);
        display: flex;
        justify-content: space-between;
        gap: 20px;
      }

      ::selection {
        background-color: var(--primary-color);
        color: rgb(0, 0, 0);
      }

      ::-webkit-scrollbar {
        width: 2px;
        height: 2px;
      }

      :focus {
        outline: var(--primary-color) solid 1px;
      }

      body {
        -ms-user-select: none;
        -moz-user-select: none;
        -khtml-user-select: none;
        -webkit-user-select: none;
        user-select: none;
      }

      ::-webkit-scrollbar-track {
        background: #f5f5f5;
      }
      ::-webkit-scrollbar-thumb {
        background: #888;
        border-radius: 10px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #555;
      }
      #login,
      #dashboard {
        display: none;
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        width: 100%;
      }
      button {
        margin: 10px 0;
        padding: 12px;
        width: 100%;
        border: none;
        border-radius: 4px;
        background-color: var(--primary-color);
        color: white;
        cursor: pointer;
        transition: background-color 0.2s;
      }
      button:hover {
        background-color: var(--primary-color-dark);
      }
      input,
      textarea {
        position: relative;
        overflow: visible;
        max-width: 100%;
        box-sizing: border-box;
        user-select: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
      }
      select {
        padding: 5px 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
        user-select: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        background-color: #fff;
      }
      input[type="text"],
      input[type="password"],
      textarea {
        width: 100%;
        padding: 10px;
        margin: 5px 0;
        border: 1px solid #ddd;
        border-radius: 4px;
        box-sizing: border-box;
        user-select: text;
        -webkit-user-select: text;
        -khtml-user-select: text;
        -moz-user-select: text;
        -ms-user-select: text;
        transition: border-color 0.2s;
      }
      input[type="text"]:focus,
      input[type="password"]:focus,
      textarea:focus {
        border-color: var(--primary-color);
        box-shadow: 0 0 5px var(--primary-color);
      }

      input:focus:invalid {
        border-color: red;
        box-shadow: 0 0 5px red;
        outline: red;
      }

      .error {
        color: #dc3545;
        margin: 5px 0;
        font-size: 14px;
        &::selection {
          background-color: #dc3545;
          color: rgb(0, 0, 0);
        }
      }
      .success {
        color: #28a745;
        margin: 5px 0;
        font-size: 14px;
        &::selection {
          background-color: #28a745;
          color: rgb(0, 0, 0);
        }
      }
      .warning {
        color: #ffc107;
        margin: 5px 0;
        font-size: 14px;
        &::selection {
          background-color: #ffc107;
          color: rgb(0, 0, 0);
        }
      }
      h2,
      h3 {
        color: #333;
        margin-top: 20px;
      }
      .section {
        margin-bottom: 20px;
        padding: 15px;
        border: 1px solid #eee;
        border-radius: 4px;
      }
      #console {
        position: relative;
        width: 100%;
        overflow: hidden;
        margin-top: 20px;
        max-height: 200px;
        overflow-y: auto;
        background: #f8f9fa;
        padding: 10px;
        border-radius: 4px;
        border: 1px solid #ddd;
      }

      #console .content {
        position: relative;
        max-height: 200px;
        overflow: auto;
        user-select: text;
        -webkit-user-select: text;
        -khtml-user-select: text;
        -moz-user-select: text;
        -ms-user-select: text;
      }

      #setAbsolute {
        position: absolute;
        bottom: 10px;
        right: 25px;
        width: 24px;
        height: 24px;
        padding: 0;
        background: #e9ecef;
        color: #495057;
        border: 1px solid #ced4da;
        border-radius: 4px;
        z-index: 1000;
        cursor: default;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
        -webkit-user-select: none;
        -khtml-user-select: none;
        user-select: none;
      }

      #console.draggable {
        position: fixed !important;
        overflow: auto;
        cursor: move;
        min-width: 200px;
        min-height: 100px;
        max-width: 800px;
        max-height: 400px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        z-index: 1000;
      }

      #console.draggable .content {
        user-select: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
      }

      #console.draggable p {
        pointer-events: none;
      }

      [disabled] {
        opacity: 0.6;
        cursor: not-allowed;
        transition: opacity 0.2s;
      }

      .modal {
        position: fixed;
        z-index: 10;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow-y: auto;
        background-color: rgba(0, 0, 0, 0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        transition: opacity 0.1s ease-in-out;
      }

      .modal.hidden {
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.2s;
      }

      .modal-content {
        background-color: #fff;
        padding: 24px;
        border-radius: 12px;
        width: 600px;
        max-width: 95%;
        max-height: 90vh;
        overflow-y: auto;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
        font-family: "Segoe UI", sans-serif;
      }

      .modal .close {
        font-size: 28px;
        font-weight: bold;
        cursor: pointer;
        position: absolute;
        right: 0;
        top: 0;
        margin-right: 3%;
        margin-top: 3%;
        color: white;
        mix-blend-mode: difference;
        z-index: 2;
      }

      .info-section {
        margin-top: 20px;
        border-top: 1px solid #ccc;
        padding-top: 10px;
      }

      .info-section h3 {
        margin-bottom: 10px;
        color: #2e2e2e;
      }

      .info-section div p {
        margin: 2px 0;
        font-size: 14px;
      }

      .output {
        border: 1px solid #ddd;
        padding: 10px;
        border-radius: 4px;
        background-color: #f8f9fa;
        min-height: 100px;
        font-family: "Courier New", Courier, monospace;
        white-space: pre-wrap;
        user-select: text;
        -webkit-user-select: text;
        -khtml-user-select: text;
        -moz-user-select: text;
        -ms-user-select: text;
      }

      .loaderico {
        border: 4px solid #f3f3f3;
        border-top: 4px solid #3498db;
        border-radius: 50%;
        width: 24px;
        height: 24px;
        animation: spin 2s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .footer {
        margin-top: 30px;
        padding-top: 15px;
        border-top: 1px solid #eee;
        font-size: 12px;
        color: #999;
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: white;
        padding: 15px;
        text-align: center;
        z-index: 2;
      }

      .footer span {
        font-weight: 600;
        color: #666;
      }

      .footer a {
        color: var(--primary-color);
        text-decoration: none;
      }

      .footer a:hover {
        text-decoration: underline;
      }

      .footer a:visited {
        color: var(--primary-color);
      }
      .rounded {
        border-radius: 6px;
      }
      .circulate {
        border-radius: 50%;
      }
      .primary {
        color: var(--primary-color);
      }
      .bubble {
        position: fixed;
        padding: 10px;
        margin-top: 10px;
        top: 10px;
        right: 10px;
        z-index: 1000;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        transition: opacity 0.3s ease-in-out;
      }
      .bubble.info {
        background-color: #d1ecf1;
        color: #0c5460;
      }
      .bubble.success {
        background-color: #d4edda;
        color: #155724;
      }
      .bubble.error {
        background-color: #f8d7da;
        color: #721c24;
      }
      .bubble.warning {
        background-color: #fff3cd;
        color: #856404;
      }

      @media (max-width: 1035px) {
        body {
          flex-direction: column;
          align-items: center;
        }
        #console {
          bottom: 10px;
          right: 10px;
          width: 100%;
          max-width: 50%;
          max-height: 50px;
          position: fixed;
          overflow-y: auto;
          background: #f8f9fa;
          padding: 10px;
          border-radius: 4px;
          border: 1px solid #ddd;
          z-index: 1000;
        }
        #dashboard,
        #login {
          width: 100%;
        }
        #setAbsolute {
          display: none !important;
        }
        .footer {
          text-align: left;
          padding: 5px;
        }
      }
    </style>
  </head>
  <body>
    <div id="login">
      <h3>Token ile Giriş</h3>
      <input
        type="password"
        id="tokenInput"
        placeholder="Token giriniz"
        required
      />
      <button onclick="checkToken()">Giriş Yap</button>
      <p id="loginMsg" class="error"></p>
    </div>

    <div id="dashboard">
      <h2>Kontrol Paneli</h2>

      <div class="section">
        <h3>Sistem Kontrolü</h3>
        <button onclick="sendCmd('shutdown')">Bilgisayarı Kapat</button>
        <button onclick="sendCmd('reboot')">Bilgisayarı Yeniden Başlat</button>
      </div>

      <div class="section">
        <h3>Popup Mesaj Göster</h3>
        <textarea
          id="popupMsg"
          rows="3"
          placeholder="Mesaj yazınız..."
        ></textarea>
        <select
          name="popupType"
          title="Popup Mesaj Türünü Seçin"
          id="popupType"
        >
          <option value="info">Bilgi</option>
          <option value="warning">Uyarı</option>
          <option value="error">Hata</option>
        </select>
        <label for="popupOntop"
          >Üstte Göster
          <input type="checkbox" id="popupOntop" checked />
        </label>
        <button
          onclick="sendPopup(document.getElementById('popupType').value, document.getElementById('popupOntop').checked)"
        >
          Mesaj Gönder
        </button>
      </div>

      <div class="section">
        <h3>Dosya Oluştur</h3>
        <input type="text" id="filePath" placeholder="Dosya yolu" required />
        <input type="text" id="fileName" placeholder="Dosya adı" required />
        <textarea
          id="fileContent"
          rows="3"
          placeholder="Dosya içeriği"
        ></textarea>
        <button onclick="sendCreateFile()">Dosya Oluştur</button>
      </div>

      <div class="section">
        <h3>Komut</h3>
        <input
          type="text"
          id="commandInput"
          placeholder="Komut giriniz"
          onkeypress="if (event.key === 'Enter') { runCommand(document.getElementById('commandInput').value); }"
        />
        <button
          onclick="runCommand(document.getElementById('commandInput').value)"
        >
          Gönder
        </button>
        <div class="output" id="commandOutput"></div>
      </div>
      <div class="section">
        <h3>Cihaz Bilgisi</h3>
        <button onclick="getDeviceInfo()">Cihaz Bilgilerini Al</button>
        <div id="deviceInfoModal" class="modal hidden">
          <div class="modal-content">
            <span class="close" onclick="closeDeviceInfoModal()">&times;</span>
            <h2>Cihaz Bilgileri</h2>

            <div class="info-section">
              <h3>Sistem</h3>
              <div id="systemInfo"></div>
            </div>

            <div class="info-section">
              <h3>Donanım</h3>
              <div id="hardwareInfo"></div>
            </div>

            <div class="info-section">
              <h3>Disk & Bellek</h3>
              <div id="storageInfo"></div>
            </div>

            <div class="info-section">
              <h3>Python</h3>
              <div id="pythonInfo"></div>
            </div>
          </div>
        </div>
      </div>

      <div class="section">
        <h3>Sunucu</h3>
        <button
          onclick="stopServer();"
          id="stopServerBtn"
          style="background-color: red"
        >
          Servisi Durdur
        </button>
        <button onclick="restartServer();" id="restartServerBtn">
          Yeniden Başlat
        </button>
      </div>

      <div class="section">
        <h3>Oturum</h3>
        <button
          onclick="logout(); showSuccess('Oturum kapatıldı.');"
          style="background-color: red"
        >
          Çıkış Yap
        </button>
      </div>
    </div>
    <div id="console">
      <div class="content"></div>
      <button id="setAbsolute" onclick="setConsoleAbsolute()">
        <svg
          width="20"
          height="20"
          viewBox="0 0 24 24"
          xmlns="http://www.w3.org/2000/svg"
          fill="#495057"
        >
          <rect
            x="3"
            y="5"
            width="18"
            height="14"
            rx="2"
            ry="2"
            stroke="#495057"
            stroke-width="2"
            fill="none"
          />
          <path
            d="M12 2v8"
            stroke="#495057"
            stroke-width="2"
            stroke-linecap="round"
          />
          <path
            d="M9 7l3 3 3-3"
            fill="none"
            stroke="#495057"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
      </button>
    </div>

    <div id="connectForm" style="display: none">
      <form id="userForm" onsubmit="submitConnectForm(event)">
        <label>
          IPv4 Address:
          <input
            type="text"
            name="ip"
            pattern="^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.|$)){4}$"
            required
            placeholder="192.168.0.1"
            title="Please enter a valid IPv4 address"
          />
        </label>

        <label>
          Port Number:
          <input
            type="text"
            name="port"
            pattern="^([0-9]{1,5})$"
            required
            placeholder="8080"
            title="Please enter a valid port number"
          />
        </label>

        <div
          style="
            max-height: 5ch;
            overflow: auto;
            border: rgba(0, 0, 0, 0.1) solid 2px;
            padding: 4px;
          "
        >
          <label for="agree">
            <input type="checkbox" name="agree" id="agree" required />
            I confirm that I am the owner or authorized user of all devices
            accessed through this system. I agree not to use this system for any
            unauthorized access, misuse, data theft, damage, or any illegal
            activity. I understand that any violation of these terms may result
            in immediate suspension of access and potential legal action.
          </label>
        </div>

        <div
          style="
            margin-top: 20px;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
          "
        >
          <button type="submit">Connect Device</button>
        </div>
      </form>
      <p id="connectMsg" style="display: block; margin-top: 4px"></p>
    </div>

    <script src="base.js"></script>

    <script>
      if (window.fetch && typeof window.fetch === "function") {
      } else {
        console.error("Fetch API not supported. Please use a modern browser.");
        alert(
          "Your browser does not support the fetch API. Please use a modern browser."
        );
        window.location.href = "https://www.google.com/chrome/";
        throw new Error("Fetch API not supported");
      }
    </script>
    <script src="script.js"></script>

    <script id="connect">
      loginDiv.style.display = "block";
      createModal(
        "Connect Device",
        document.getElementById("connectForm").innerHTML,
        "connectionModal",
        false
      );
      async function submitConnectForm(event) {
        event.preventDefault();

        const form = event.target;
        const data = {
          ip: form.ip.value,
          port: form.port.value,
          agree: form.agree.checked,
        };

        if (!data.agree) {
          form.agree.setCustomValidity("Please agree to the terms.");
          form.agree.reportValidity();
          return;
        }
        form.agree.setCustomValidity("");

        form.querySelector("button[type='submit']").disabled = true;
        result = await connectServer(data.ip, data.port);
        let connectMsg =
          getModal("connectionModal").querySelector("#connectMsg");
        if (result.status) {
          if (result.status == 200) {
            ip = form.ip.value;
            port = form.port.value;
            base = "http://" + ip + ":" + port;
            updateSS();

            connectMsg.className = "";
            connectMsg.innerHTML = "Checking version...";
            requestForServer("/version")
              .onSuccess((data) => {
                if (data.status == 200) {
                  RCversion = data.text();
                  if (RCversion == version) {
                    console.log("Connected to server");
                    connectMsg.className = "success";
                    connectMsg.innerHTML =
                      "Your RemoteControl server is connected and up to date!";
                    removeModal("connectionModal");
                  } else {
                    console.log("Connected to server");
                    connectMsg.className = "success";
                    connectMsg.innerHTML =
                      "Your RemoteControl server is connected!";
                    removeModal("connectionModal");
                  }
                } else if (data.status == 404) {
                  form.querySelector("button[type='submit']").disabled = false;
                  connectMsg.className = "error";
                  connectMsg.innerHTML =
                    "Your Remote Control version is too old to contain the server version, please update it";
                } else {
                  form.querySelector("button[type='submit']").disabled = false;
                  console.log("Failed to get version: " + data.status);
                  connectMsg.className = "error";
                }
              })
              .onError((error) => {
                form.querySelector("button[type='submit']").disabled = false;
                console.error("Failed to get version: " + error.message);
                connectMsg.className = "error";
                connectMsg.innerHTML =
                  "Failed to get version: " + error.message;
              })
              .send();
          } else if (result.status == 403) {
            form.querySelector("button[type='submit']").disabled = false;
            connectMsg.className = "error";
            connectMsg.innerHTML =
              "You have been banned by the system administrator, your access to the server is permanently blocked";
          }
        } else {
          console.error("Connection failed");
          form.querySelector("button[type='submit']").disabled = false;
          connectMsg.className = "error";
          connectMsg.innerHTML = "Connection failed: " + result.message;
        }
      }
    </script>

    <footer class="footer">
      Powered by
      <span
        ><a href="https://github.com/EnbloxC3/RemoteContol/" target="_blank"
          >RemoteControl</a
        ></span
      >
    </footer>
  </body>
</html>
